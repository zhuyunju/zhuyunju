(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{418:function(s,t,a){s.exports=a.p+"assets/img/Express.9dec2a63.png"},419:function(s,t,a){s.exports=a.p+"assets/img/express02.15d2cb0d.png"},420:function(s,t,a){s.exports=a.p+"assets/img/Session.0f37e2ea.png"},421:function(s,t,a){s.exports=a.p+"assets/img/JWT.9961994f.png"},439:function(s,t,a){"use strict";a.r(t);var n=a(62),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"node-js"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#node-js"}},[s._v("#")]),s._v(" Node.js")]),s._v(" "),n("h2",{attrs:{id:"node-js与内置模块"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#node-js与内置模块"}},[s._v("#")]),s._v(" Node.js与内置模块")]),s._v(" "),n("h3",{attrs:{id:"node-js-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#node-js-2"}},[s._v("#")]),s._v(" Node.js")]),s._v(" "),n("blockquote",[n("p",[s._v("Node.js® is a JavaScript runtime built on Chrome's V8 JavaScript engine.\nNode.js 是一个基于 Chrome V8 引擎的 JavaScript 运行环境。\n"),n("a",{attrs:{href:"https://nodejs.org/zh-cn/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Node.js官网"),n("OutboundLink")],1)])]),s._v(" "),n("h4",{attrs:{id:"作用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#作用"}},[s._v("#")]),s._v(" 作用")]),s._v(" "),n("ul",[n("li",[s._v("基于 Express 框架（http://www.expressjs.com.cn/），可以快速构建 Web 应用")]),s._v(" "),n("li",[s._v("基于 Electron 框架（https://electronjs.org/），可以构建跨平台的桌面应用")]),s._v(" "),n("li",[s._v("基于 restify 框架（http://restify.com/），可以快速构建 API 接口项目")]),s._v(" "),n("li",[s._v("读写和操作数据库、创建实用的命令行工具辅助前端开发")])]),s._v(" "),n("h3",{attrs:{id:"fs文件系统模块"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#fs文件系统模块"}},[s._v("#")]),s._v(" fs文件系统模块")]),s._v(" "),n("blockquote",[n("p",[s._v("fs 模块是 Node.js 官方提供的、用来操作文件的模块。它提供了一系列的方法和属性，用来满足用户对文件的操作需求")])]),s._v(" "),n("ul",[n("li",[s._v("fs.readFile()方法,用来读取指定文件中的内容\n"),n("ul",[n("li",[s._v("参数1："),n("strong",[s._v("必选")]),s._v("参数文件路径")]),s._v(" "),n("li",[s._v("参数2：可选参数编码格式读取")]),s._v(" "),n("li",[s._v("参数3："),n("strong",[s._v("必选")]),s._v("参数回调函数拿取数据")])])]),s._v(" "),n("li",[s._v("fs.writeFile()方法,用来向指定文件中写入内容\n"),n("ul",[n("li",[s._v("参数1："),n("strong",[s._v("必选")]),s._v("参数文件路径")]),s._v(" "),n("li",[s._v("参数2："),n("strong",[s._v("必选")]),s._v("参数，表示写入的内容")]),s._v(" "),n("li",[s._v("参数3：可选参数编码格式读取")]),s._v(" "),n("li",[s._v("参数4："),n("strong",[s._v("必选")]),s._v("参数回调函数")])])]),s._v(" "),n("li",[s._v("语法:")])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 在javascipt使用fs模块需要先导入")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" fs "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fs'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1、fs.readFile()语法格式")]),s._v("\nfs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("readFile")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./files/1.text'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'utf-8'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 2.fs.writeFile()")]),s._v("\nfs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("writeFile")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./files/1.text'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Hello Node.js'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("err")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("h4",{attrs:{id:"fs模块-动态拼接问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#fs模块-动态拼接问题"}},[s._v("#")]),s._v(" fs模块-动态拼接问题")]),s._v(" "),n("blockquote",[n("p",[s._v("在使用 fs 模块操作文件时，如果提供的操作路径是以 "),n("strong",[s._v("./")]),s._v(" 或 "),n("strong",[s._v("../")]),s._v(" 开头的"),n("strong",[s._v("相对路径")]),s._v("时，很容易出现路径动态拼接错误的问题。\n原因：代码在运行的时候，"),n("strong",[s._v("会以执行 node 命令时所处的目录")]),s._v("，动态拼接出被操作文件的完整路径。\n解决方案：在使用 fs 模块操作文件时，"),n("strong",[s._v("直接提供完整的路径")]),s._v("，不要提供 ./ 或 ../ 开头的相对路径，从而防止路径动态拼接的问题。")])]),s._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),n("p",[n("font",{staticStyle:{color:"red"}},[s._v("_dirname表示当前文件所处目录")])],1)]),s._v(" "),n("h3",{attrs:{id:"path路径模块"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#path路径模块"}},[s._v("#")]),s._v(" path路径模块")]),s._v(" "),n("blockquote",[n("p",[s._v("path 模块是 Node.js 官方提供的、用来处理路径的模块。它提供了一系列的方法和属性，用来满足用户对路径的处理\n需求。")])]),s._v(" "),n("ul",[n("li",[n("p",[s._v("path.join() 方法，用来将多个路径片段拼接成一个完整的路径字符串")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("path.join([...paths])")])]),s._v(" "),n("li",[s._v("...paths string  路径片段的序列")]),s._v(" "),n("li",[s._v("返回值: string")])])]),s._v(" "),n("li",[n("p",[s._v("path.basename() 方法，用来从路径字符串中，将文件名解析出来")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("path.basename(path[,ext])")])]),s._v(" "),n("li",[s._v("path string 必选参数，表示一个路径的字符串")]),s._v(" "),n("li",[s._v("ext string 可选参数，表示文件扩展名")]),s._v(" "),n("li",[s._v("返回: string 表示路径中的最后一部分")])])])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// path.join() 方法")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" fpath "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'path'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" pathStr "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("_dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/e'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pathStr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 输出： 当前目录位置\\e")]),s._v("\n    \n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// path.basename() 方法")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" fpath "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/a/b/c/index.html'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//文件路径")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" fullname "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("basename")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fpath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fullname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//输出 index.html")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("ul",[n("li",[s._v("获取文件扩展名：path.extname()\n"),n("ul",[n("li",[n("code",[s._v("path.extname(path)")])]),s._v(" "),n("li",[s._v("path string 必选参数，表示一个路径的字符串")]),s._v(" "),n("li",[s._v("返回: string 返回得到的扩展名字符串")])])])]),s._v(" "),n("h3",{attrs:{id:"http模块"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#http模块"}},[s._v("#")]),s._v(" http模块")]),s._v(" "),n("blockquote",[n("p",[s._v("http 模块是 Node.js 官方提供的、用来创建 web 服务器的模块。通过 http 模块提供的 http.createServer() 方法，就\n能方便的把一台普通的电脑，变成一台 Web 服务器，从而对外提供 Web 资源服务。")])]),s._v(" "),n("h4",{attrs:{id:"创建基本的web服务器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建基本的web服务器"}},[s._v("#")]),s._v(" 创建基本的web服务器")]),s._v(" "),n("ul",[n("li",[s._v("创建Web服务器的基本步骤\n"),n("ul",[n("li",[s._v("导入http模块")]),s._v(" "),n("li",[s._v("创建web服务器实例")]),s._v(" "),n("li",[s._v("为服务器绑定request事件,监听客服端的请求")]),s._v(" "),n("li",[s._v("启动服务器")])])])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 导入http模块")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" http "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 创建web服务器实例")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" server "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" http"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("createServer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 为服务器绑定request事件,监听客服端的请求")]),s._v("\nserver"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'request'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 只要客户端请求自己的服务器就会触发request事件,从而调用这个事件处理函数")]),s._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'someone vist our server.'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 启动服务器")]),s._v("\nserver"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("listen")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'htpp server runing at http://127.0.0.1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("h5",{attrs:{id:"req请求对象"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#req请求对象"}},[s._v("#")]),s._v(" req请求对象")]),s._v(" "),n("ul",[n("li",[s._v("req 请求对象包含了与客户端相关的属性和数据，例如")]),s._v(" "),n("li",[s._v("req.url 是客户端请求的url地址")]),s._v(" "),n("li",[s._v("req.method 是客户端的method请求类型")])]),s._v(" "),n("h5",{attrs:{id:"res请响应象"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#res请响应象"}},[s._v("#")]),s._v(" res请响应象")]),s._v(" "),n("ul",[n("li",[s._v("res 是响应对象,包含了服务器相关的数据和属性，例如")]),s._v(" "),n("li",[s._v("res.end(str)向客户端发送指定内容,并结束这次请求处理过程")])]),s._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),n("p",[s._v("解决中文乱码问题")]),s._v(" "),n("blockquote",[n("p",[s._v("当调用 res.end() 方法，向客户端发送中文内容的时候，会出现乱码问题，此时，需要手动设置内容的编码格式：\n"),n("strong",[s._v("res.setHeader('Content-Type','text/html;charset=utf-8')")])])])]),s._v(" "),n("h2",{attrs:{id:"模块化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#模块化"}},[s._v("#")]),s._v(" 模块化")]),s._v(" "),n("h3",{attrs:{id:"模块化的基本概念"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#模块化的基本概念"}},[s._v("#")]),s._v(" 模块化的基本概念")]),s._v(" "),n("blockquote",[n("p",[s._v("模块化是指解决一个复杂问题时，自顶向下逐层把系统划分成若干模块的过程。对于整个系统来说，模块是可组合、分解和更换的单元。")])]),s._v(" "),n("h3",{attrs:{id:"node-js模块化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#node-js模块化"}},[s._v("#")]),s._v(" Node.js模块化")]),s._v(" "),n("h4",{attrs:{id:"node-js中模块的分类"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#node-js中模块的分类"}},[s._v("#")]),s._v(" Node.js中模块的分类")]),s._v(" "),n("ul",[n("li",[s._v("内置模块（内置模块是由 Node.js 官方提供的，例如 fs、path、http 等）")]),s._v(" "),n("li",[s._v("（用户创建的每个 .js 文件，都是自定义模块）")]),s._v(" "),n("li",[s._v("（由第三方开发出来的模块，并非官方提供的内置模块，也不是用户创建的自定义模块，使用前需要先下载）")])]),s._v(" "),n("h4",{attrs:{id:"加载模块"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#加载模块"}},[s._v("#")]),s._v(" 加载模块")]),s._v(" "),n("blockquote",[n("p",[s._v("使用强大的 require() 方法，可以加载需要的内置模块、用户自定义模块、第三方模块进行使用。")])]),s._v(" "),n("h4",{attrs:{id:"模块作用域"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#模块作用域"}},[s._v("#")]),s._v(" 模块作用域")]),s._v(" "),n("blockquote",[n("p",[s._v("和函数作用域类似，在自定义模块中定义的变量、方法等成员，只能在当前模块内被访问，这种模块级别的访问限制，叫做模块作用域。")])]),s._v(" "),n("ul",[n("li",[s._v("好处\n"),n("ul",[n("li",[s._v("防止了全局变量污染的问题")])])])]),s._v(" "),n("h4",{attrs:{id:"向外共享模块作用域中的成员"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#向外共享模块作用域中的成员"}},[s._v("#")]),s._v(" 向外共享模块作用域中的成员")]),s._v(" "),n("ul",[n("li",[s._v("module对象\n"),n("ul",[n("li",[s._v("在每个 .js 自定义模块中都有一个 module 对象，它里面存储了和当前模块有关的信息")])])]),s._v(" "),n("li",[s._v("module.exports对象\n"),n("ul",[n("li",[s._v("在自定义模块中，可以使用 module.exports 对象，将模块内的成员共享出去，供外界使用。\n外界用 require() 方法导入自定义模块时，得到的就是 module.exports 所指向的对象。")])])]),s._v(" "),n("li",[s._v("共享成员时的注意点\n"),n("ul",[n("li",[s._v("使用 require() 方法导入模块时，导入的结果，"),n("strong",[s._v("永远以 module.exports 指向的对象为准。")])])])]),s._v(" "),n("li",[s._v("exports对象\n"),n("ul",[n("li",[s._v("由于 module.exports 单词写起来比较复杂，为了简化向外共享成员的代码，Node 提供了 exports 对象。默认情况下，exports 和 module.exports 指向同一个对象。最终共享的结果，还是以 module.exports 指向的对象为准。")])])])]),s._v(" "),n("h4",{attrs:{id:"node-js中模块化规范"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#node-js中模块化规范"}},[s._v("#")]),s._v(" Node.js中模块化规范")]),s._v(" "),n("blockquote",[n("p",[s._v("Node.js 遵循了 CommonJS 模块化规范，CommonJS 规定了模块的特性和各模块之间如何相互依赖。")])]),s._v(" "),n("ul",[n("li",[s._v("每个模块内部，module 变量代表当前模块。")]),s._v(" "),n("li",[s._v("module 变量是一个对象，它的 exports 属性（即 module.exports）是对外的接口。")]),s._v(" "),n("li",[s._v("加载某个模块，其实是加载该模块的 module.exports 属性。require() 方法用于加载模块。")])]),s._v(" "),n("h3",{attrs:{id:"npm与包"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#npm与包"}},[s._v("#")]),s._v(" npm与包")]),s._v(" "),n("ul",[n("li",[s._v("什么是包\n"),n("ul",[n("li",[s._v("Node.js 中的第三方模块又叫做包。")])])]),s._v(" "),n("li",[s._v("包的来源\n"),n("ul",[n("li",[s._v("不同于 Node.js 中的内置模块与自定义模块，包是由第三方个人或团队开发出来的，免费供所有人使用。")])])]),s._v(" "),n("li",[s._v("为什么需要包\n"),n("ul",[n("li",[s._v("由于 Node.js 的内置模块仅提供了一些底层的 API，导致在基于内置模块进行项目开发的时，效率很低。\n包是基于内置模块封装出来的，提供了更高级、更方便的 API，极大的提高了开发效率。\n包和内置模块之间的关系，类似于 jQuery 和 浏览器内置 API 之间的关系。\n"),n("a",{attrs:{href:"https://www.npmjs.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("npm官网"),n("OutboundLink")],1)])])])]),s._v(" "),n("h2",{attrs:{id:"express"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#express"}},[s._v("#")]),s._v(" Express")]),s._v(" "),n("h3",{attrs:{id:"express简介"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#express简介"}},[s._v("#")]),s._v(" Express简介")]),s._v(" "),n("blockquote",[n("p",[s._v("官方给出的概念：Express 是基于 Node.js 平台，快速、开放、极简的 Web 开发框架。\n通俗的理解：Express 的作用和 Node.js 内置的 http 模块类似，是专门用来创建 Web 服务器的。\nExpress 的本质：就是一个 npm 上的第三方包，提供了快速创建 Web 服务器的便捷方法。\n"),n("a",{attrs:{href:"http://www.expressjs.com.cn/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Express官网"),n("OutboundLink")],1)])]),s._v(" "),n("h4",{attrs:{id:"express的基本使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#express的基本使用"}},[s._v("#")]),s._v(" Express的基本使用")]),s._v(" "),n("ul",[n("li",[s._v("安装:"),n("code",[s._v("npm install express")])])]),s._v(" "),n("h5",{attrs:{id:"_1、创建基本的web服务器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、创建基本的web服务器"}},[s._v("#")]),s._v(" 1、创建基本的Web服务器")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 导入express")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" express "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'express'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 创建web服务器")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" app "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("express")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 启动服务器")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("listen")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'express server runing at http://127.0.0.1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h5",{attrs:{id:"_2、监听get请求"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、监听get请求"}},[s._v("#")]),s._v(" 2、监听Get请求")]),s._v(" "),n("p",[n("code",[s._v("app.get('请求路径URL',function(req,res){/*处理函数*/})")])]),s._v(" "),n("ul",[n("li",[s._v("参数1：客户端请求URL地址")]),s._v(" "),n("li",[s._v("参数2：请求对应的处理函数")]),s._v(" "),n("li",[s._v("req:亲求对象")]),s._v(" "),n("li",[s._v("res:响应对象")])]),s._v(" "),n("h5",{attrs:{id:"_3、监听post请求"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3、监听post请求"}},[s._v("#")]),s._v(" 3、监听Post请求")]),s._v(" "),n("p",[n("code",[s._v("app.post('请求路径URL',function(req,res){/*处理函数*/)")])]),s._v(" "),n("ul",[n("li",[s._v("参数1：客户端请求URL地址")]),s._v(" "),n("li",[s._v("参数2：请求对应的处理函数")]),s._v(" "),n("li",[s._v("req:亲求对象")]),s._v(" "),n("li",[s._v("res:响应对象")])]),s._v(" "),n("h5",{attrs:{id:"_4、把内容响应给客户端"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4、把内容响应给客户端"}},[s._v("#")]),s._v(" 4、把内容响应给客户端")]),s._v(" "),n("p",[n("strong",[s._v("通过res.send()方法")]),s._v(",发送给客户端")]),s._v(" "),n("h5",{attrs:{id:"_5、获取url中携带的参数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5、获取url中携带的参数"}},[s._v("#")]),s._v(" 5、获取URL中携带的参数")]),s._v(" "),n("blockquote",[n("p",[s._v("通过 req.query 对象，可以访问到客户端通过查询字符串的形式，发送到服务器的参数：")])]),s._v(" "),n("h5",{attrs:{id:"_6、获取url中的动态参数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6、获取url中的动态参数"}},[s._v("#")]),s._v(" 6、获取URL中的动态参数")]),s._v(" "),n("blockquote",[n("p",[s._v("通过 req.params 对象，可以访问到 URL 中，通过 : 匹配到的动态参数")])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 获取URL中携带的参数")]),s._v("\n    app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("query"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 获取URL中的动态参数")]),s._v("\n     app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/:id'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("params"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h4",{attrs:{id:"托管静态资源"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#托管静态资源"}},[s._v("#")]),s._v(" 托管静态资源")]),s._v(" "),n("h4",{attrs:{id:"_1、express-static"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、express-static"}},[s._v("#")]),s._v(" 1、express.static()")]),s._v(" "),n("blockquote",[n("p",[s._v("express 提供了一个非常好用的函数，叫做 express.static()，通过它，我们可以非常方便地创建一个静态资源服务器，例如，通过如下代码就可以将 public 目录下的图片、CSS 文件、JavaScript 文件对外开放访问了：\n"),n("code",[s._v("app.use(express.static('public'))")]),s._v("\n注意：Express 在指定的静态目录中查找文件，并对外提供资源的访问路径。\n因此，"),n("strong",[s._v("存放静态文件的目录名不会出现在 URL 中")]),s._v("。")])]),s._v(" "),n("h5",{attrs:{id:"托管多个静态资源目录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#托管多个静态资源目录"}},[s._v("#")]),s._v(" 托管多个静态资源目录")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("express"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("static")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'public'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("express"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sattic")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'files'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h5",{attrs:{id:"挂载路径前缀"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#挂载路径前缀"}},[s._v("#")]),s._v(" 挂载路径前缀")]),s._v(" "),n("ul",[n("li",[s._v("如果希望在托管的静态资源访问路径之前，挂载路径前缀，则可以使用如下的方式：\n"),n("code",[s._v("app.use('/public',express.sattic('public'))")])])]),s._v(" "),n("h3",{attrs:{id:"express路由"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#express路由"}},[s._v("#")]),s._v(" Express路由")]),s._v(" "),n("h4",{attrs:{id:"路由的概念"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#路由的概念"}},[s._v("#")]),s._v(" 路由的概念")]),s._v(" "),n("blockquote",[n("p",[s._v("路由：广义上来讲，路由就是映射关系。在 Express 中，路由指的是客户端的请求与服务器处理函数之间的映射关系。")])]),s._v(" "),n("ul",[n("li",[s._v("1、在 Express 中，路由指的是"),n("strong",[s._v("客户端的请求")]),s._v("与"),n("strong",[s._v("服务器处理函数")]),s._v("之间的"),n("strong",[s._v("映射关系")]),s._v("。")]),s._v(" "),n("li",[s._v("2、Express中路由的例子")])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 匹配GET请求,且请求URL为/")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Hello World!'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 匹配POST请求,且请求URL为/")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("post")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Got a Post request'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("ul",[n("li",[s._v("3、路由的匹配过程")])]),s._v(" "),n("blockquote",[n("p",[s._v("每当一个请求到达服务器之后，"),n("strong",[s._v("需要先经过路由的匹配")]),s._v("，只有匹配成功之后，才会调用对应的处理函数。\n在匹配时，会按照路由的顺序进行匹配，如果"),n("strong",[s._v("请求类型")]),s._v("和"),n("strong",[s._v("请求的 URL")]),s._v(" 同时匹配成功，则 Express 会将这次请求，转交给对应的 function 函数进行处理。")])]),s._v(" "),n("h4",{attrs:{id:"路由的使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#路由的使用"}},[s._v("#")]),s._v(" 路由的使用")]),s._v(" "),n("h5",{attrs:{id:"最简单的用法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#最简单的用法"}},[s._v("#")]),s._v(" 最简单的用法")]),s._v(" "),n("p",[s._v("在 Express 中使用路由最简单的方式，就是把路由挂载到 app 上，示例代码如下：")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" express "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'express'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 创建web服务器,命名为app")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" app "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("express")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 挂载路由")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Hello World!'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("post")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Got a Post request'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 启动web服务器")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("listen")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'server runing at http://127.0.0.1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("h5",{attrs:{id:"模块化路由"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#模块化路由"}},[s._v("#")]),s._v(" 模块化路由")]),s._v(" "),n("blockquote",[n("p",[s._v("为了方便对路由进行模块化的管理，Express 不建议将路由直接挂载到 app 上，而是推荐将路由抽离为单独的模块。\n将路由抽离为单独模块的步骤如下：\n将路由抽离为单独模块的步骤如下：")])]),s._v(" "),n("ul",[n("li",[s._v("创建路由模块对应的.js文件")]),s._v(" "),n("li",[s._v("调用express.Router()函数创建路由对象")]),s._v(" "),n("li",[s._v("向路由挂载具体路由")]),s._v(" "),n("li",[s._v("使用module.exports向外共享路由对象")]),s._v(" "),n("li",[s._v("使用app.use()函数注册路由模块")])]),s._v(" "),n("h6",{attrs:{id:"创建路由模块"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建路由模块"}},[s._v("#")]),s._v(" 创建路由模块")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 在创建的js文件中./router/user.js")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" express "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'express'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//导入express")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" router "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" express"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("Router")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//创建路由对象")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 挂载路由")]),s._v("\nrouter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/user/list'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Get user list.'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nrouter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("post")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/user/add'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Add new user'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nmodule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exports "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" router\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 注册路由模块导入路由模块")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" userRouter "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./router/user.js'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 使用app.use()注册路由模块")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("userRouter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 也可以添加前缀app.use()注册路由模块")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/api'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("userRouter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])]),n("h3",{attrs:{id:"express中间件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#express中间件"}},[s._v("#")]),s._v(" Express中间件")]),s._v(" "),n("h4",{attrs:{id:"中间件的概念"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#中间件的概念"}},[s._v("#")]),s._v(" 中间件的概念")]),s._v(" "),n("blockquote",[n("p",[s._v("中间件（Middleware ），特指业务流程的中间处理环节。")])]),s._v(" "),n("h5",{attrs:{id:"express中间件的调用流程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#express中间件的调用流程"}},[s._v("#")]),s._v(" Express中间件的调用流程")]),s._v(" "),n("blockquote",[n("p",[s._v("当一个请求到达 Express 的服务器之后，可以连续调用多个中间件，从而对这次请求进行预处理。\n"),n("img",{attrs:{src:a(418),alt:"Express"}})])]),s._v(" "),n("h5",{attrs:{id:"express中间件格式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#express中间件格式"}},[s._v("#")]),s._v(" Express中间件格式")]),s._v(" "),n("p",[s._v("Express 的中间件，本质上就是一个 function 处理函数，Express 中间件的格式如下：")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" express "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'express'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" app "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("express")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("listen")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),n("p",[s._v("注意：中间件函数的形参列表中，必须包含 next 参数。而路由处理函数中只包含 req 和 res。")])]),s._v(" "),n("h5",{attrs:{id:"next函数的作用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#next函数的作用"}},[s._v("#")]),s._v(" next函数的作用")]),s._v(" "),n("blockquote",[n("p",[s._v("next 函数是实现多个中间件连续调用的关键，它表示把流转关系转交给下一个中间件或路由。\n"),n("img",{attrs:{src:a(419),alt:"exp02"}})])]),s._v(" "),n("h4",{attrs:{id:"express中间件的初体验"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#express中间件的初体验"}},[s._v("#")]),s._v(" Express中间件的初体验")]),s._v(" "),n("h5",{attrs:{id:"_1-定义中间件函数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-定义中间件函数"}},[s._v("#")]),s._v(" 1.定义中间件函数")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 常量mv所指向的，就是一个中间件函数")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("mv")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'这是一个中件间函数'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 注意：当前中间件处理完毕后，必须调用next()函数")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 表示：把流转关系交给下一个中间件或路由")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h5",{attrs:{id:"_2-全局生效的中间件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-全局生效的中间件"}},[s._v("#")]),s._v(" 2.全局生效的中间件")]),s._v(" "),n("p",[s._v("客户端发起的任何请求，到达服务器之后，"),n("strong",[s._v("都会触发的中间件")]),s._v("，叫做全局生效的中间件。\n通过调用 "),n("strong",[s._v("app.use(中间件函数)")]),s._v("，即可定义一个"),n("strong",[s._v("全局生效的中间件")]),s._v("。")]),s._v(" "),n("h5",{attrs:{id:"_3-局部生效的中间件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-局部生效的中间件"}},[s._v("#")]),s._v(" 3.局部生效的中间件")]),s._v(" "),n("p",[s._v("不使用 app.use() 定义的中间件，叫做局部生效的中间件，示例代码如下：")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 定义中间件函数mv1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("mv1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'中间件函数'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("mv2")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'中间件函数'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 局部生效：当前路由中生效")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("mv1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'hello'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 多个局部中间件")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mv1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("mv2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'hello'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("h5",{attrs:{id:"_3-中间件的作用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-中间件的作用"}},[s._v("#")]),s._v(" 3.中间件的作用")]),s._v(" "),n("p",[s._v("多个中间件之间，"),n("strong",[s._v("共享同一份 req 和 res")]),s._v("。基于这样的特性，我们可以在"),n("strong",[s._v("上游")]),s._v("的中间件中，统一为 req 或 res 对象添加"),n("strong",[s._v("自定义")]),s._v("的"),n("strong",[s._v("属性")]),s._v("或"),n("strong",[s._v("方法")]),s._v("，供"),n("strong",[s._v("下游")]),s._v("的中间件或路由进行使用。")]),s._v(" "),n("h5",{attrs:{id:"_4-中间件的注意事项"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-中间件的注意事项"}},[s._v("#")]),s._v(" 4.中间件的注意事项")]),s._v(" "),n("ul",[n("li",[s._v("一定要在"),n("strong",[s._v("路由之前")]),s._v("注册中间件")]),s._v(" "),n("li",[s._v("客户端发送过来的请求，"),n("strong",[s._v("可以连续调用多个")]),s._v("中间件进行处理")]),s._v(" "),n("li",[s._v("执行完中间件的业务代码之后，"),n("strong",[s._v("不要忘记调用 next() 函数")])]),s._v(" "),n("li",[s._v("为了"),n("strong",[s._v("防止代码逻辑混乱")]),s._v("，调用 next() 函数后不要再写额外的代码")]),s._v(" "),n("li",[s._v("连续调用多个中间件时，多个中间件之间，"),n("strong",[s._v("共享")]),s._v(" req 和 res 对象")])]),s._v(" "),n("h4",{attrs:{id:"中间件的分类"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#中间件的分类"}},[s._v("#")]),s._v(" 中间件的分类")]),s._v(" "),n("ul",[n("li",[n("strong",[s._v("应用级别")]),s._v("的中间件")]),s._v(" "),n("li",[n("strong",[s._v("路由级别")]),s._v("的中间件")]),s._v(" "),n("li",[n("strong",[s._v("错误级别")]),s._v("的中间件")]),s._v(" "),n("li",[n("strong",[s._v("Express内置")]),s._v("的中间件")]),s._v(" "),n("li",[n("strong",[s._v("第三方")]),s._v("的中间件")])]),s._v(" "),n("h5",{attrs:{id:"_1-应用级别的中间件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-应用级别的中间件"}},[s._v("#")]),s._v(" 1.应用级别的中间件")]),s._v(" "),n("p",[s._v("通过 app.use() 或 app.get() 或 app.post() ，绑定到 app 实例上的中间件，叫做应用级别的中间件。")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 应用级别的中间件(全局中间件)")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 应用级别中间件(局部中间件)")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("mv1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'home page.'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h5",{attrs:{id:"_2-路由级别的中间件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-路由级别的中间件"}},[s._v("#")]),s._v(" 2.路由级别的中间件")]),s._v(" "),n("p",[s._v("绑定到 "),n("strong",[s._v("express.Router()")]),s._v(" 实例上的中间件，叫做路由级别的中间件。它的用法和应用级别中间件没有任何区别。只不过，"),n("strong",[s._v("应用级别中间件是绑定到 app 实例上，路由级别中间件绑定到 router 实例上")])]),s._v(" "),n("h5",{attrs:{id:"_3-错误级别的中间件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-错误级别的中间件"}},[s._v("#")]),s._v(" 3.错误级别的中间件")]),s._v(" "),n("p",[s._v("错误级别中间件的"),n("strong",[s._v("作用")]),s._v("：专门用来捕获整个项目中发生的异常错误，从而防止项目异常崩溃的问题。\n"),n("strong",[s._v("格式")]),s._v("：错误级别中间件的 function 处理函数中，"),n("strong",[s._v("必须有 4 个形参")]),s._v("，形参顺序从前到后，分别是 (err, req, res, next)。")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//路由")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Error")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'服务器内部发送了错误！'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//抛出异常")]),s._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Home page.'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//错误级别中间件")]),s._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'发生了错误：'")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("message"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 在服务器打印错误消息")]),s._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Error'")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("message"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 发送给客户端错误相关信息")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),n("p",[s._v("注意：错误级别的中间件，必须注册在所有路由之后")])]),s._v(" "),n("h5",{attrs:{id:"_4-express内置的中间件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-express内置的中间件"}},[s._v("#")]),s._v(" 4.Express内置的中间件")]),s._v(" "),n("blockquote",[n("p",[s._v("自 Express 4.16.0 版本开始，Express 内置了 3 个常用的中间件，极大的提高了 Express 项目的开发效率和体验：")])]),s._v(" "),n("ul",[n("li",[s._v("express.static 快速托管静态资源的内置中间件，例如： HTML 文件、图片、CSS 样式等（无兼容性）")]),s._v(" "),n("li",[s._v("express.json 解析 JSON 格式的请求体数据（有兼容性，仅在 4.16.0+ 版本中可用）")]),s._v(" "),n("li",[s._v("express.urlencoded 解析 URL-encoded 格式的请求体数据（有兼容性，仅在 4.16.0+ 版本中可用）")])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 配置解析application/json格式数据的内置中间件")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("express"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("json")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 配置解析application/x-www-form-urlencoded格式数据的内置中间插件")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("express"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("urlencoded")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("extended")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h5",{attrs:{id:"_5-第三方的中间件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-第三方的中间件"}},[s._v("#")]),s._v(" 5.第三方的中间件")]),s._v(" "),n("blockquote",[n("p",[s._v("非 Express 官方内置的，而是由第三方开发出来的中间件，叫做第三方中间件。在项目中，大家可以按需下载并配置第三方中间件，从而提高项目的开发效率")])]),s._v(" "),n("h3",{attrs:{id:"使用express写接口"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用express写接口"}},[s._v("#")]),s._v(" 使用Express写接口")]),s._v(" "),n("h4",{attrs:{id:"cors跨域资源共享"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#cors跨域资源共享"}},[s._v("#")]),s._v(" CORS跨域资源共享")]),s._v(" "),n("ul",[n("li",[s._v("CORS(主流的解决方案，推荐使用)")]),s._v(" "),n("li",[s._v("JSONP(有缺陷的解决方案:只支持GET请求)")])]),s._v(" "),n("h5",{attrs:{id:"使用cors中间件解决跨域问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用cors中间件解决跨域问题"}},[s._v("#")]),s._v(" 使用CORS中间件解决跨域问题")]),s._v(" "),n("blockquote",[n("p",[s._v("cors 是 Express 的一个第三方中间件。通过安装和配置 cors 中间件，可以很方便地解决跨域问题。\n使用步骤分为如下 3 步：")])]),s._v(" "),n("ul",[n("li",[s._v("运行 npm install cors 安装中间件")]),s._v(" "),n("li",[s._v("使用 const cors = require('cors') 导入中间件")]),s._v(" "),n("li",[s._v("在路由之前调用 app.use(cors()) 配置中间件")])]),s._v(" "),n("h5",{attrs:{id:"什么是cors"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#什么是cors"}},[s._v("#")]),s._v(" 什么是CORS")]),s._v(" "),n("blockquote",[n("p",[s._v("CORS （Cross-Origin Resource Sharing，跨域资源共享）由一系列 HTTP 响应头组成，这些 HTTP 响应头决定浏览器是否阻止前端 JS 代码跨域获取资源。\n浏览器的同源安全策略默认会阻止网页“跨域”获取资源。但如果接口服务器配置了 CORS 相关的 HTTP 响应头，就可以解除浏览器端的跨域访问限制。")])]),s._v(" "),n("h5",{attrs:{id:"cors注意事项"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#cors注意事项"}},[s._v("#")]),s._v(" CORS注意事项")]),s._v(" "),n("ul",[n("li",[s._v("CORS 主要在"),n("strong",[s._v("服务器端")]),s._v("进行配置。客户端浏览器无须做"),n("strong",[s._v("任何额外的配置")]),s._v("，即可请求开启了 CORS 的接口。")]),s._v(" "),n("li",[s._v("CORS 在浏览器中有兼容性。只有支持 XMLHttpRequest Level2 的浏览器，才能正常访问开启了 CORS 的服务端接口（例如：IE10+、Chrome4+、FireFox3.5+）。")])]),s._v(" "),n("h2",{attrs:{id:"数据库与身份认证"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#数据库与身份认证"}},[s._v("#")]),s._v(" 数据库与身份认证")]),s._v(" "),n("h3",{attrs:{id:"数据库的基本概念"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#数据库的基本概念"}},[s._v("#")]),s._v(" 数据库的基本概念")]),s._v(" "),n("h4",{attrs:{id:"什么是数据库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#什么是数据库"}},[s._v("#")]),s._v(" 什么是数据库")]),s._v(" "),n("blockquote",[n("p",[s._v("数据库（database）是用来组织、存储和管理数据的仓库。\n当今世界是一个充满着数据的互联网世界，充斥着大量的数据。数据的来源有很多，比如出行记录、消费记录、浏览的网页、发送的消息等等。除了文本类型的数据，图像、音乐、声音都是数据。\n为了方便管理互联网世界中的数据，就有了数据库管理系统的概念（简称：数据库）。用户可以对数据库中的数据进行新增、查询、更新、删除等操作。")])]),s._v(" "),n("h4",{attrs:{id:"常见的数据库及分类"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#常见的数据库及分类"}},[s._v("#")]),s._v(" 常见的数据库及分类")]),s._v(" "),n("ul",[n("li",[s._v("Mysql数据库(目前使用最广泛、流行度最高的开源免费数据库；Community + Enterprise)")]),s._v(" "),n("li",[s._v("Oracle数据库(收费)")]),s._v(" "),n("li",[s._v("SQL Server数据库(收费)")]),s._v(" "),n("li",[s._v("Mongobd数据库(Community + Enterprise)\n其中，MySQL、Oracle、SQL Server 属于"),n("strong",[s._v("传统型数据库")]),s._v("（又叫做："),n("strong",[s._v("关系型数据库")]),s._v(" 或 "),n("strong",[s._v("SQL 数据库")]),s._v("），这三者的设计理念相同，用法比较类似。\n而 Mongodb 属于"),n("strong",[s._v("新型数据库")]),s._v("（又叫做："),n("strong",[s._v("非关系型数据库")]),s._v(" 或 "),n("strong",[s._v("NoSQL 数据库")]),s._v("），它在一定程度上弥补了传统型数据库的缺陷。")])]),s._v(" "),n("h3",{attrs:{id:"mysql的基本使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mysql的基本使用"}},[s._v("#")]),s._v(" MySQL的基本使用")]),s._v(" "),n("h4",{attrs:{id:"什么是sql"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#什么是sql"}},[s._v("#")]),s._v(" 什么是SQL")]),s._v(" "),n("blockquote",[n("p",[s._v("SQL（英文全称：Structured Query Language）是结构化查询语言，专门用来访问和处理数据库的编程语言。能够让我们以编程的形式，操作数据库里面的数据。")])]),s._v(" "),n("h4",{attrs:{id:"sql学习目标-增删查改"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sql学习目标-增删查改"}},[s._v("#")]),s._v(" SQL学习目标(增删查改)")]),s._v(" "),n("ul",[n("li",[n("strong",[s._v("查询数据")]),s._v("(select)")]),s._v(" "),n("li",[n("strong",[s._v("插入数据")]),s._v("(insert into)")]),s._v(" "),n("li",[n("strong",[s._v("更新数据")]),s._v("(update)")]),s._v(" "),n("li",[n("strong",[s._v("删除数据")]),s._v("(delete)\n4中SQL语法:\n"),n("strong",[s._v("where条件")]),s._v("、"),n("strong",[s._v("and和or运算符")]),s._v("、"),n("strong",[s._v("rder by排序")]),s._v("、"),n("strong",[s._v("count(*)函数")])])]),s._v(" "),n("h4",{attrs:{id:"sql的select语句"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sql的select语句"}},[s._v("#")]),s._v(" SQL的SELECT语句")]),s._v(" "),n("p",[s._v("语法：")]),s._v(" "),n("div",{staticClass:"language-SQL line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 这是注释")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 从FROM指定[表中],查询出[所有的]数据。*表示[所有列]")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" 表名称\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 从FROM指定[表中],查询出[指定列]数据。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" 列名称 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" 表名称\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),n("p",[s._v("注意：SQL 语句中的关键字对大小写不敏感。SELECT 等效于 select，FROM 等效于 from")])]),s._v(" "),n("h4",{attrs:{id:"sql的insert-into-语句"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sql的insert-into-语句"}},[s._v("#")]),s._v(" SQL的INSERT INTO 语句")]),s._v(" "),n("p",[s._v("语法")]),s._v(" "),n("div",{staticClass:"language-SQL line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 语法解读：向指定的表中,插入如下几列数据,列的值通过Values ——指定")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 注意：列和值要一对应,多个列和多个值之间,使用英文的逗号分隔")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" 表名"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("列名"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("列名"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VALUES")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("值"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("值"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h4",{attrs:{id:"sql的update语句"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sql的update语句"}},[s._v("#")]),s._v(" SQL的UPDATE语句")]),s._v(" "),n("div",{staticClass:"language-SQL line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 语法解读：")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 1.用UPDATE指定要更新那个表中的数据")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 2.用SET指定列对应的新值")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 3.用WHERE指定更新的条件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("UPDATE")]),s._v(" 表名称 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" 列名称 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 新值 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" 列名称 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 某值\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h4",{attrs:{id:"sql的delete语句"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sql的delete语句"}},[s._v("#")]),s._v(" SQL的DELETE语句")]),s._v(" "),n("p",[s._v("语法")]),s._v(" "),n("div",{staticClass:"language-SQL line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 语法解读：")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 从指定表中，根据where条件，删除对应的数据行")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DELETE")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" 表名称 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" 列名称 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 值\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h4",{attrs:{id:"sql的where子句"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sql的where子句"}},[s._v("#")]),s._v(" SQL的WHERE子句")]),s._v(" "),n("blockquote",[n("p",[s._v("WHERE 子句用于限定选择的标准。在 SELECT、UPDATE、DELETE 语句中，皆可使用 WHERE 子句来限定选择的标准。\n语法:")])]),s._v(" "),n("div",{staticClass:"language-SQL line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 查询语句中的WHERE条件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" 列名称 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" 表名称 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" 列 运算符 值\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 更新语句中的WHERE条件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("UPDATE")]),s._v(" 表名称 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" 列 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 新值 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" 列 运算符 值\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 删除语句的WHERE条件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DELETE")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" 表名称 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" 列 运算符 值\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h4",{attrs:{id:"sql的where可使用的运算符"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sql的where可使用的运算符"}},[s._v("#")]),s._v(" SQL的WHERE可使用的运算符")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[s._v("操作符")]),s._v(" "),n("th",[s._v("描述")])])]),s._v(" "),n("tbody",[n("tr",[n("td",[s._v("=")]),s._v(" "),n("td",[s._v("等于")])]),s._v(" "),n("tr",[n("td",[s._v("<>")]),s._v(" "),n("td",[s._v("不等于")])]),s._v(" "),n("tr",[n("td",[s._v(">")]),s._v(" "),n("td",[s._v("大于")])]),s._v(" "),n("tr",[n("td",[s._v("<")]),s._v(" "),n("td",[s._v("小于")])]),s._v(" "),n("tr",[n("td",[s._v(">=")]),s._v(" "),n("td",[s._v("大于等于")])]),s._v(" "),n("tr",[n("td",[s._v("<=")]),s._v(" "),n("td",[s._v("小于等于")])]),s._v(" "),n("tr",[n("td",[s._v("BETWEEN")]),s._v(" "),n("td",[s._v("在某个范围内")])]),s._v(" "),n("tr",[n("td",[s._v("LIKE")]),s._v(" "),n("td",[s._v("搜索某种模式")])])])]),s._v(" "),n("h4",{attrs:{id:"sql的and和or运算符"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sql的and和or运算符"}},[s._v("#")]),s._v(" SQL的AND和OR运算符")]),s._v(" "),n("p",[s._v("语法")]),s._v(" "),n("ul",[n("li",[s._v("AND 和 OR 可在 WHERE 子语句中把两个或多个条件结合起来。")]),s._v(" "),n("li",[s._v("AND 表示必须同时满足多个条件，相当于 JavaScript 中的 && 运算符，例如 if (a !== 10 && a !== 20)")]),s._v(" "),n("li",[s._v("OR 表示只要满足任意一个条件即可，相当于 JavaScript 中的 || 运算符，例如 if(a !== 10 || a !== 20)")])]),s._v(" "),n("h4",{attrs:{id:"sql的order-by-子句"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sql的order-by-子句"}},[s._v("#")]),s._v(" SQL的ORDER BY 子句")]),s._v(" "),n("p",[s._v("语法")]),s._v(" "),n("ul",[n("li",[s._v("ORDER BY语句用指定根据指定的列对结果集进行排序。")]),s._v(" "),n("li",[s._v("ORDER BY 语句默认按照升序对记录进行排序。")]),s._v(" "),n("li",[s._v("如果您希望按照降序对记录进行排序，可以使用 DESC 关键字。")])]),s._v(" "),n("div",{staticClass:"language-SQL line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 注意：如下两条SQL语句是等价。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--  因为ORDER BY 默认进行升序排序")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--  其中,ASC关键字代表降序排序")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" 表 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ORDER")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" 字段   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 升序")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" 表 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ORDER")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v(" 字段 "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ASC")]),s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 降序")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h4",{attrs:{id:"sql的count-函数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sql的count-函数"}},[s._v("#")]),s._v(" SQL的COUNT(*)函数")]),s._v(" "),n("p",[s._v("语法：\nCOUNT(*) 函数用于返回查询结果的总数据条数，语法格式如下：\n"),n("code",[s._v("SELECT COUNT(*) FROM 表名称")])]),s._v(" "),n("h4",{attrs:{id:"as为列设置别名"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#as为列设置别名"}},[s._v("#")]),s._v(" AS为列设置别名")]),s._v(" "),n("p",[n("code",[s._v("SELECT COUNT(*)AS total FROM users WHERE status=0")])]),s._v(" "),n("h3",{attrs:{id:"在项目中操作mysql"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#在项目中操作mysql"}},[s._v("#")]),s._v(" 在项目中操作MySQL")]),s._v(" "),n("h4",{attrs:{id:"项目中操着数据的步骤"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#项目中操着数据的步骤"}},[s._v("#")]),s._v(" 项目中操着数据的步骤")]),s._v(" "),n("ul",[n("li",[s._v("1、安装操作MySQL数据库的第三方模块(mysql)")]),s._v(" "),n("li",[s._v("2、通过MySQL模块连接到MySQL数据库")]),s._v(" "),n("li",[s._v("3、通过MySQL模块执行SQL语句")])]),s._v(" "),n("h5",{attrs:{id:"_1、安装mysql模块"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、安装mysql模块"}},[s._v("#")]),s._v(" 1、安装mysql模块")]),s._v(" "),n("blockquote",[n("p",[s._v("mysql 模块是托管于 npm 上的第三方模块。它提供了在 Node.js 项目中连接和操作 MySQL 数据库的能力。\n想要在项目中使用它，需要先运行如下命令，将 mysql 安装为项目的依赖包：\n"),n("code",[s._v("npm install mysql")])])]),s._v(" "),n("h5",{attrs:{id:"_2、配置mysql模块"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2、配置mysql模块"}},[s._v("#")]),s._v(" 2、配置mysql模块")]),s._v(" "),n("blockquote",[n("p",[s._v("在使用 mysql 模块操作 MySQL 数据库之前，必须先对 mysql 模块进行必要的配置，主要的配置步骤如下：")])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1、导入mySQL模块")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" mysql "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mysql'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 2、建立与MySQL数据库的连接")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" db "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" mysql"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("createPool")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("host")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'127.0.0.1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//数据库的IP地址")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("user")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 数据库账号")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("password")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'admin123'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//登录数据库密码")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("database")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'my_db_01'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//指定操作那个数据库")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 3、检测mysql模块是否能正常工作")]),s._v("\ndb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("query")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'select 1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("results")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("message"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 只要打印出[Rowdatapacket{'1':1}]的结果,就证明数据库连接正常")]),s._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("results"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 查询数据")]),s._v("\ndb"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("query")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'select * from user'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("results")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("message"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ressults"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])]),n("h3",{attrs:{id:"前后的的身份认证"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#前后的的身份认证"}},[s._v("#")]),s._v(" 前后的的身份认证")]),s._v(" "),n("h4",{attrs:{id:"web开发模式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#web开发模式"}},[s._v("#")]),s._v(" Web开发模式")]),s._v(" "),n("p",[s._v("目前主流的Web开发模式有两种,分别是:")]),s._v(" "),n("ul",[n("li",[s._v("1、基于服务端渲染的传统Web开发模式")]),s._v(" "),n("li",[s._v("2、基于前后端分离的新型Web开发模式")])]),s._v(" "),n("h5",{attrs:{id:"_1-服务端渲染的-web-开发模式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-服务端渲染的-web-开发模式"}},[s._v("#")]),s._v(" 1. 服务端渲染的 Web 开发模式")]),s._v(" "),n("blockquote",[n("p",[s._v("服务端渲染的概念：服务器发送给客户端的 HTML 页面，是在服务器通过字符串的拼接，动态生成的。因此，客户端不需要使用 Ajax 这样的技术额外请求页面的数据。代码示例如下：")])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./index.html'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 要渲染的数据")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" user "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'zs'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("age")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 服务端通过字符串的拼接,动态生成HTML内容")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" html "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'<h1>姓名：$(user.name)</h1>'")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 把生成好的页面内容响应给客户端,因此,客户端拿到的是带有真是数据的HTML页面")]),s._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("html"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h5",{attrs:{id:"_2-前后端分离的web开发模式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-前后端分离的web开发模式"}},[s._v("#")]),s._v(" 2. 前后端分离的Web开发模式")]),s._v(" "),n("blockquote",[n("p",[s._v("前后端分离的概念：前后端分离的开发模式，依赖于 Ajax 技术的广泛应用。简而言之，前后端分离的 Web 开发模式，就是后端只负责提供 API 接口，前端使用 Ajax 调用接口的开发模式。")])]),s._v(" "),n("h4",{attrs:{id:"身份认证"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#身份认证"}},[s._v("#")]),s._v(" 身份认证")]),s._v(" "),n("h5",{attrs:{id:"_1-什么是身份认证"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-什么是身份认证"}},[s._v("#")]),s._v(" 1.什么是身份认证")]),s._v(" "),n("blockquote",[n("p",[s._v("身份认证（Authentication）又称“身份验证”、“鉴权”，是指通过一定的手段，完成对用户身份的确认。")])]),s._v(" "),n("h5",{attrs:{id:"_2-不同开发模式的身份认证"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-不同开发模式的身份认证"}},[s._v("#")]),s._v(" 2.不同开发模式的身份认证")]),s._v(" "),n("p",[s._v("对于服务端渲染和前后端分离这两种开发模式来说，分别有着不同的身份认证方案：")]),s._v(" "),n("ul",[n("li",[s._v("服务端渲染推荐使用 Session 认证机制")]),s._v(" "),n("li",[s._v("前后端分离推荐使用 JWT 认证机制")])]),s._v(" "),n("h5",{attrs:{id:"session认证机制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#session认证机制"}},[s._v("#")]),s._v(" Session认证机制")]),s._v(" "),n("h6",{attrs:{id:"_1-http协议的无状态性"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-http协议的无状态性"}},[s._v("#")]),s._v(" 1.HTTP协议的无状态性")]),s._v(" "),n("blockquote",[n("p",[s._v("HTTP 协议的无状态性，指的是"),n("strong",[s._v("客户端的每次 HTTP 请求都是独立的")]),s._v("，连续多个请求之间没有直接的关系，"),n("strong",[s._v("服务器不会主动保留每次 HTTP 请求的状态")]),s._v("。")])]),s._v(" "),n("h6",{attrs:{id:"_2-如何突破-http-无状态的限制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-如何突破-http-无状态的限制"}},[s._v("#")]),s._v(" 2.如何突破 HTTP 无状态的限制")]),s._v(" "),n("blockquote",[n("p",[s._v("对于超市来说，为了方便收银员在进行结算时给 VIP 用户打折，超市可以为每个 VIP 用户发放会员卡。\n现实生活中的会员卡身份认证方式，在 Web 开发中的专业术语叫做 "),n("strong",[s._v("Cookie")]),s._v("。")])]),s._v(" "),n("h6",{attrs:{id:"_3-什么是cookie"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-什么是cookie"}},[s._v("#")]),s._v(" 3.什么是Cookie")]),s._v(" "),n("blockquote",[n("p",[s._v("Cookie 是存储在用户浏览器中的一段不超过 4 KB 的字符串。它由一个名称（Name）、一个值（Value）和其它几个用于控制 Cookie 有效期、安全性、使用范围的可选属性组成。\n不同域名下的 Cookie 各自独立，每当客户端发起请求时，会"),n("strong",[s._v("自动")]),s._v("把当前域名下所有"),n("strong",[s._v("未过期的 Cookie")]),s._v(" 一同发送到服务器。\n"),n("strong",[s._v("Cookie的几大特性：")])])]),s._v(" "),n("ul",[n("li",[s._v("1.自动发送")]),s._v(" "),n("li",[s._v("2.域名独立")]),s._v(" "),n("li",[s._v("3.过期时限")]),s._v(" "),n("li",[s._v("4.4KB限制")])]),s._v(" "),n("h6",{attrs:{id:"_4-cookie在身份认证中的作用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-cookie在身份认证中的作用"}},[s._v("#")]),s._v(" 4.Cookie在身份认证中的作用")]),s._v(" "),n("p",[s._v("客户端第一次请求服务器的时候，服务器通过"),n("strong",[s._v("响应头的形式")]),s._v("，向客户端发送一个身份认证的 Cookie，客户端会自动将 Cookie 保存在浏览器中。\n随后，当客户端浏览器每次请求服务器的时候，浏览器会"),n("strong",[s._v("自动")]),s._v("将身份认证相关的 Cookie，"),n("strong",[s._v("通过请求头的形式")]),s._v("发送给服务器，服务器即可验明客户端的身份。")]),s._v(" "),n("h6",{attrs:{id:"_5-cookie-不具有安全性"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-cookie-不具有安全性"}},[s._v("#")]),s._v(" 5.Cookie 不具有安全性")]),s._v(" "),n("p",[s._v("由于 Cookie 是存储在浏览器中的，而且"),n("strong",[s._v("浏览器也提供了读写 Cookie 的 API")]),s._v("，因此 "),n("strong",[s._v("Cookie 很容易被伪造")]),s._v("，不具有安全性。因此不建议服务器将重要的隐私数据，通过 Cookie 的形式发送给浏览器。")]),s._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),n("p",[s._v("注意：千万不要使用 Cookie 存储重要且隐私的数据！比如用户的身份信息、密码等")])]),s._v(" "),n("h6",{attrs:{id:"_6-提高身份认证的安全性"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-提高身份认证的安全性"}},[s._v("#")]),s._v(" 6.提高身份认证的安全性")]),s._v(" "),n("p",[s._v("为了防止客户伪造会员卡，收银员在拿到客户出示的会员卡之后，可以在收银机上进行刷卡认证。只有收银机确认存在的会员卡，才能被正常使用。\n这种“"),n("strong",[s._v("会员卡")]),s._v(" + "),n("strong",[s._v("刷卡认证")]),s._v("”的设计理念，就是 Session 认证机制的精髓。")]),s._v(" "),n("h6",{attrs:{id:"_7-session-的工作原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-session-的工作原理"}},[s._v("#")]),s._v(" 7. Session 的工作原理")]),s._v(" "),n("p",[n("img",{attrs:{src:a(420),alt:"Session"}})]),s._v(" "),n("h5",{attrs:{id:"在-express-中使用-session-认证"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#在-express-中使用-session-认证"}},[s._v("#")]),s._v(" 在 Express 中使用 Session 认证")]),s._v(" "),n("h6",{attrs:{id:"_1-安装-express-session-中间件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装-express-session-中间件"}},[s._v("#")]),s._v(" 1."),n("strong",[s._v("安装")]),s._v(" express-session 中间件")]),s._v(" "),n("p",[s._v("在 Express 项目中，只需要安装 express-session 中间件，即可在项目中使用 Session 认证：\n"),n("code",[s._v("npm install express-session")])]),s._v(" "),n("h6",{attrs:{id:"_2-配置-express-session-中间件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-配置-express-session-中间件"}},[s._v("#")]),s._v(" 2."),n("strong",[s._v("配置")]),s._v(" express-session 中间件")]),s._v(" "),n("p",[s._v("express-session 中间件安装成功后，需要通过 app.use() 来注册 session 中间件，示例代码如下：")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 1、导入session中间件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" session "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'express-session'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 2、配置Session中间件")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("session")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("secret")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'keyboard cat'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// secret属性值可以为任意字符串(随便写)")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("resave")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("flase "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//resave是指每次请求都重新设置session cookie，假设你的cookie是10分钟过期，每次请求都会再设置10分钟")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("saveUninitialized")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//aveUninitialized是指无论有没有session cookie，每次请求都设置个session cookie ，默认给个标示为 connect.sid")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h6",{attrs:{id:"_3-向-session-中存数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-向-session-中存数据"}},[s._v("#")]),s._v(" 3.向 session 中存数据")]),s._v(" "),n("p",[s._v("当 express-session 中间件配置成功后，即可通过 "),n("strong",[s._v("req.session")]),s._v(" 来访问和使用 session 对象，从而存储用户的关键信息：")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("post")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/api/login'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 判断用户提交登录信息是否正确")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("body"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("username "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'admin'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("body"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("password "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'000000'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("status")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("msg")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'登录失败'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    \n    req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("session"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("user "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("body "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//将用户信息,存储到Session中")]),s._v("\n    req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("session"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("islogin "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//将用户登录状态存储到Session中")]),s._v("\n\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("status")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("msg")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'登录成功'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("h6",{attrs:{id:"_4-从-session-中取数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-从-session-中取数据"}},[s._v("#")]),s._v(" 4.从 session 中取数据")]),s._v(" "),n("p",[s._v("可以直接从 req.session 对象上获取之前存储的数据，示例代码如下：")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 获取用户姓名接口")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/api/username'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 判断用户是否登录")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("session"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("islogin"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("status")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("msg")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fail'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("status")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("msg")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'success'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("username")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("session"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("username"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h6",{attrs:{id:"_5-清空-session"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-清空-session"}},[s._v("#")]),s._v(" 5. 清空 session")]),s._v(" "),n("p",[s._v("调用 "),n("strong",[s._v("req.session.destroy()")]),s._v(" 函数，即可清空服务器保存的 session 信息。")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 退出登录接口")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("post")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/api/logout'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 清空当前客户端对应的session信息")]),s._v("\n    req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("session"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("destroy")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("statis")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("msg")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'退出登录成功'")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h5",{attrs:{id:"jwt-认证机制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#jwt-认证机制"}},[s._v("#")]),s._v(" JWT 认证机制")]),s._v(" "),n("h6",{attrs:{id:"_1-了解session认证的局限性"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-了解session认证的局限性"}},[s._v("#")]),s._v(" 1.了解Session认证的局限性")]),s._v(" "),n("blockquote",[n("p",[s._v("Session 认证机制"),n("strong",[s._v("需要配合 Cookie 才能实现")]),s._v("。由于 Cookie 默认不支持跨域访问，所以，当"),n("strong",[s._v("涉及到前端跨域请求后端接口")]),s._v("的时候，"),n("strong",[s._v("需要做很多额外的配置")]),s._v("，才能实现跨域 Session 认证。")])]),s._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("注意")]),s._v(" "),n("ul",[n("li",[s._v("当前端请求后端接口不存在跨域问题的时候，推荐使用 Session 身份认证机制。")]),s._v(" "),n("li",[s._v("当前端需要跨域请求后端接口的时候，不推荐使用 Session 身份认证机制，推荐使用 JWT 认证机制。")])])]),s._v(" "),n("h6",{attrs:{id:"_2-什么是-jwt"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-什么是-jwt"}},[s._v("#")]),s._v(" 2. 什么是 JWT")]),s._v(" "),n("blockquote",[n("p",[s._v("JWT（英文全称：JSON Web Token）是目前最流行的跨域认证解决方案。")])]),s._v(" "),n("h6",{attrs:{id:"_3-jwt-的工作原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-jwt-的工作原理"}},[s._v("#")]),s._v(" 3. JWT 的工作原理")]),s._v(" "),n("p",[n("img",{attrs:{src:a(421),alt:"jwt"}}),s._v("\n总结：用户的信息通过 Token 字符串的形式，保存在客户端浏览器中。服务器通过还原 Token 字符串的形式来认证用户的身份。")]),s._v(" "),n("h6",{attrs:{id:"_4-jwt-的组成部分"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-jwt-的组成部分"}},[s._v("#")]),s._v(" 4. JWT 的组成部分")]),s._v(" "),n("blockquote",[n("p",[s._v("JWT 通常由三部分组成，分别是 Header（头部）、Payload（有效荷载）、Signature（签名）。\n三者之间使用英文的“.”分隔，格式如下：\n"),n("code",[s._v("Header.payload.Signature")])])]),s._v(" "),n("h6",{attrs:{id:"_5-jwt-的三个部分各自代表的含义"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-jwt-的三个部分各自代表的含义"}},[s._v("#")]),s._v(" 5. JWT 的三个部分各自代表的含义")]),s._v(" "),n("p",[s._v("JWT 的三个组成部分，从前到后分别是 Header、Payload、Signature。\n其中：")]),s._v(" "),n("ul",[n("li",[n("strong",[s._v("Payload")]),s._v(" 部分才是真正的用户信息**，它是用户信息经过加密之后生成的字符串。")]),s._v(" "),n("li",[s._v("Header 和 Signature 是"),n("strong",[s._v("安全性相关")]),s._v("的部分，只是为了保证 Token 的安全性。")])]),s._v(" "),n("h6",{attrs:{id:"_7-jwt-的使用方式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-jwt-的使用方式"}},[s._v("#")]),s._v(" 7. JWT 的使用方式")]),s._v(" "),n("p",[s._v("客户端收到服务器返回的 JWT 之后，通常会将它储存在 "),n("strong",[s._v("localStorage")]),s._v(" 或 "),n("strong",[s._v("sessionStorage")]),s._v(" 中。\n此后，客户端每次与服务器通信，都要带上这个 JWT 的字符串，从而进行身份认证。推荐的做法是把 "),n("strong",[s._v("JWT 放在 HTTP 请求头的 Authorization 字段中")]),s._v("，格式如下：\n"),n("code",[s._v("Authorization:Bearer<token>")])]),s._v(" "),n("h5",{attrs:{id:"在-express-中使用-jwt"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#在-express-中使用-jwt"}},[s._v("#")]),s._v(" 在 Express 中使用 JWT")]),s._v(" "),n("h6",{attrs:{id:"_1-安装-jwt-相关的包"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装-jwt-相关的包"}},[s._v("#")]),s._v(" 1. 安装 JWT 相关的包")]),s._v(" "),n("p",[s._v("运行如下命令，安装如下两个 JWT 相关的包：\n"),n("code",[s._v("npm install jsonwebtoken express-jwt")]),s._v("\n其中：")]),s._v(" "),n("ul",[n("li",[s._v("jsonwebtoken 用于生成 JWT 字符串")]),s._v(" "),n("li",[s._v("express-jwt 用于将 JWT 字符串解析还原成 JSON 对象")])]),s._v(" "),n("h6",{attrs:{id:"_2-导入-jwt-相关的包"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-导入-jwt-相关的包"}},[s._v("#")]),s._v(" 2. 导入 JWT 相关的包")]),s._v(" "),n("p",[s._v("使用 require() 函数，分别导入 JWT 相关的两个包")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" jwt "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sonwebtoken'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" expressJWT "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'express-jwt'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h6",{attrs:{id:"_3-定义-secret-密钥"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-定义-secret-密钥"}},[s._v("#")]),s._v(" 3. 定义 secret 密钥")]),s._v(" "),n("p",[s._v("为了保证 JWT 字符串的安全性，防止 JWT 字符串在网络传输过程中被别人破解，我们需要专门定义一个用于加密和解密的 secret 密钥：")]),s._v(" "),n("ul",[n("li",[s._v("当生成 JWT 字符串的时候，需要使用 secret 密钥对用户的信息进行加密，最终得到加密好的 JWT 字符串")]),s._v(" "),n("li",[s._v("当把 JWT 字符串解析还原成 JSON 对象的时候，需要使用 secret 密钥进行解密")])]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 3.secret 密钥的本质：就是一个字符串")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" secretKey "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'HELLO WORLD!^_^'")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h6",{attrs:{id:"_4-在登录成功后生成-jwt-字符串"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-在登录成功后生成-jwt-字符串"}},[s._v("#")]),s._v(" 4.在登录成功后生成 JWT 字符串")]),s._v(" "),n("p",[s._v("调用 jsonwebtoken 包提供的 sign() 方法，将用户的信息加密成 JWT 字符串，响应给客户端：")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 登录接口")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("post")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/api/login'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 登录之后代码。。。。")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 登录成功后，生成JWT字符串，通过token属性响应给客户端")]),s._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("status")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("mes")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'登录成功'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 调用jwt.sign()生成JWT字符串,三个参数分别是：用户信息、secret密钥、配置对象时效")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("token")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("jwt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sign")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("username")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("userinfo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("username"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("secretKey"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("expiresIn")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'30s'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("h6",{attrs:{id:"_5-将-jwt-字符串还原为-json-对象"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-将-jwt-字符串还原为-json-对象"}},[s._v("#")]),s._v(" 5. 将 JWT 字符串还原为 JSON 对象")]),s._v(" "),n("p",[s._v("客户端每次在访问那些有权限接口的时候，都需要主动通过"),n("strong",[s._v("请求头中的 Authorization 字段")]),s._v("，将 Token 字符串发送到服务器进行身份认证。\n此时，服务器可以通过 "),n("strong",[s._v("express-jwt")]),s._v(" 这个中间件，自动将客户端发送过来的 Token 解析还原成 JSON 对象：")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//使用app.use()来注册中间件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// expressJWT({secret:secretKey})解析token中间件")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// .unless({path:[/^\\api\\//]})用来指定那些接口不需要访问权限")]),s._v("\napp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("expressJWT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("secret")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("secretKey"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("unless")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("path")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token regex"}},[n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),n("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("^\\/api\\/")]),n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h6",{attrs:{id:"_6-使用-req-user-获取用户信息"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-使用-req-user-获取用户信息"}},[s._v("#")]),s._v(" 6. 使用 req.user 获取用户信息")]),s._v(" "),n("p",[s._v("当 express-jwt 这个中间件配置成功之后，即可在那些有权限的接口中，使用 "),n("strong",[s._v("req.user")]),s._v(" 对象，来访问从 JWT 字符串中解析出来的用户信息了，示例代码如下：")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/admin/getinfo'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("status")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("message")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'获取用户信息成功！'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("data")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("user\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h6",{attrs:{id:"_7-捕获解析-jwt-失败后产生的错误"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-捕获解析-jwt-失败后产生的错误"}},[s._v("#")]),s._v(" 7. 捕获解析 JWT 失败后产生的错误")]),s._v(" "),n("p",[s._v("当使用 express-jwt 解析 Token 字符串时，如果客户端发送过来的 Token 字符串"),n("strong",[s._v("过期")]),s._v("或"),n("strong",[s._v("不合法")]),s._v("，会产生一个解析失败的错误，影响项目的正常运行。我们可以通过 "),n("strong",[s._v("Express 的错误中间件")]),s._v("，捕获这个错误并进行相关的处理，示例代码如下：")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("use")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("req"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("next")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// token解析失败导致的错误")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("===")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'UnauthorizedError'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        retrun res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("status")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("401")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("message")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'无效的token'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 其他原因错误")]),s._v("\n    res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("status")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("message")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'未知错误'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);